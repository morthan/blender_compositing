OpenEXR
^^^^^^^

Квинтэссенцией всех форматов без потери качества является OpenEXR. Если у
предыдущих форматов были какие-то ограничения (ну, там, цветов маловато или
прозрачности нет), то можно с уверенностью сказать, что OpenEXR сохраняет
'всё' -- и это не будет большим преувеличением. Он сохраняет всю информацию,
которая есть в обычных картинках, а также ту, которой там обычно нет. Зато она
есть в отрендеренной графике, а именно для неё OpenEXR и создавался.

Что там в обычных изображениях? Цвета и прозрачность? Да, это в OpenEXR имеется.
Много цветов, полноценный альфа-канал... Но из обычной фотографии нельзя
автоматически определить, что вот этот столб дальше от камеры, а вон тот --
ближе. Зато OpenEXR для каждого пикселя хранит ещё и расстояние от камеры до
объекта, к которому этот пиксель относитсяfootnote:[Это называется «Z-буфер» или
«карта глубины». Используется в компьютерной графике для определения видимости
объекта или его части. За подробностями -- к Роджерсу.]. Теперь при сведении
двух графических файлов в одно целое прохожий пройдёт между двумя столбами
совершенно реалистично и нам с вами не придётся прикладывать к этому никаких
усилий. Об этом уже позаботились создатели формата.

Рендеринг графической сцены происходит в несколько этапов, называемых 'проходами
рендера'. Сначала отрисовывается цвет, потом -- освещённые места (так называемый
«блеск»), потом -- тени и так далее. Всего проходов где-то полтора десятка и они
описываются дальше, в главе, посвящённой рендерингу. Нам же сейчас важно знать,
что OpenEXR сохраняет все промежуточные проходы и позволяет обрабатывать их по
отдельности. Нужно размыть блеск, добавить цвету насыщенности, а тени подкрасить
синим? Без проблем! И, благодаря использованию OpenEXR, нам не понадобится
тратить кучу времени на повторный рендеринг.

У всякой медали две стороны. Если OpenEXR настолько хорош, то почему он нигде не
используется? Лично я, например, узнал о его существовании только в процессе
проработки материалов для написания этой книги.

Во-первых, это специализированный формат, заточенный строго под результаты
рендеринга. Z-буфер хорошая штука, но получить его из обычной плоской фотографии
не получитсяfootnote:[На самом деле при помощи некоторых костылей можно создать
более-менее точную имитацию Z-буфера, но это будет именно что костыль и
имитация.], поскольку фотоаппарат не сохраняет информацию о расстоянии до
объектов. А рендерер эту информацию сохраняет. Потому и знают об этом формате
исключительно те, кто пользуется рендерером. А таких людей гораздо меньше, чем
фотографов и кинооператоров.

Во-вторых, формат этот довольно прожорлив. Всю эту прорву информации надо где-то
хранить, она занимает место и, несмотря на использование хороших алгоритмов
сжатия, OpenEXR всё-таки проигрывает по этому параметру другим форматам, кроме,
разве что, BMP. Картинка с отрендеренным кубиком по умолчанию, сохранённая в
разных форматах, занимает:

* Windows BMP -- 5,9 Mb

* OpenEXR -- 660 Kb

* PNG -- 30 Kb.

Как говорится, почувствуйте разницу! Именно по этой причине сей полезный формат
применяется ограниченно и только в тех задачах, где без него нельзя обойтись.
Иначе никаких жёстких дисков не хватит!
