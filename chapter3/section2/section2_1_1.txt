Windows Bitmap (BMP)
^^^^^^^^^^^^^^^^^^^^

Наверное, каждый пользователь Windows хоть раз пытался нарисовать что-нибудь в
простеньком редакторе Paint. И при попытке сохранить нарисованное обнаруживал,
что  сохраняется оно в формате BMPfootnote:[В последних версиях Windows редактор
Paint наконец-то начал понимать и другие форматы -- честь и хвала ему за это! Но
BMP по-прежнему выбран по умолчанию.]. Этот формат является детищем компании
Microsoft, разработан ею давно и до наших дней дошёл в практически неизменном
состоянии.

«BMP» является сокращением слова «bitmap» -- битовая карта. Проще говоря, это
здоровенный массив чисел, каждое из которых соответствует цвету отдельного
пикселя изображения. Плюс заголовок, в котором указаны размеры изображения и
много других полезных параметров.

[NOTE]
================================================================================
Как можно заметить в том же диалоге выбора форматов при сохранении файла в
Paint, по-другому этот формат ещё называется DIB. Эта аббревиатура
расшифровывается как 'Device Independent Bitmap', то есть битовая карта,
независимая от устройства. В заголовке данного формата содержится достаточно
информации, чтобы обеспечить одинаковое воспроизведение изображения на
устройствах с различными характеристиками.
================================================================================

Дальше начинается арифметика. Один байт может принимать значения от 0 до 255.
Выделим под значения красного, зелёного и синего цветов каждого пикселя по
одному байту. Теперь посмотрим, сколько места займёт картинка, скажем, 800x600.
Умножаем 800 на 600, а потом всё это ещё на три. Итого -- 1440000 байт. Это не
считая заголовка и всего на одну небольшую по нынешним меркам картинку.

Разумеется, разработчики формата об этом подумали и добавили возможность хоть
какого-то сжатия. Для этого использовалось так называемое
RLE-кодированиеfootnote:[RLE -- Run Length Encoding, сжатие идущих подряд
одинаковых значений.]. Смысл его прост: если у нас идут подряд 250 точек одного
и того же цвета, то можно не делать две с половиной сотни дублей, а записать
команду «повторить последнюю точку столько-то раз». И размер изображения
сократится.

На некоторых рисунках, где есть большие области, залитые одним и тем же цветом,
такое сжатие давало результат. К сожалению, подавляющее большинство полутоновых
изображений (фотографий) такому сжатию не поддаётся принципиально.

У RLE-кодирования был и ещё один интересный побочный эффект. Оно позволяло
реализовать примитивную поддержку прозрачности. Действительно, вместо команды
«повторить точку 100 раз» вполне можно использовать команду «'пропустить' 100
точек». Однако, несмотря на то, что возможность такая в формате предусмотрена,
лично мне никогда не попадались программы, умеющие этой возможностью
пользоваться.

В итоге BMP стал форматом, используемым редко и, в основном, по незнанию. У него
куча недостатков и всего одно достоинство: он передаёт изображения точно и без
искажений. В нашей с вами практике этот формат, увы, практически бесполезен.
